import{d as A,y as c,c as T,l as B,p as U,a as o,f as X,g as C,e as g,u as m,h as H,w,b as a,t as r,o as l,F as h,z as y,G as M,H as q,J as D,v as G,A as I,j as W,I as J}from"./app-BazWH2cV.js";import{p as R,_ as K}from"./AppLayout.vue_vue_type_script_setup_true_lang-CsH92T7-.js";import{F as O}from"./FlashMessageFrontend-Boyro6mW.js";import{c as V}from"./createLucideIcon-DhvMzXVu.js";import"./index-O-jjLyD1.js";import"./useForwardExpose-DtkRFfkk.js";import"./VisuallyHidden-DeZUUzf8.js";import"./RovingFocusGroup-BOJDWpQZ.js";import"./useArrowNavigation-C6Y-ieo6.js";import"./index-BdvXPHPK.js";import"./AppLogoIcon.vue_vue_type_script_setup_true_lang-CAK7uAc4.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";/**
 * @license lucide-vue-next v0.468.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Q=V("SquarePenIcon",[["path",{d:"M12 3H5a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7",key:"1m0v6g"}],["path",{d:"M18.375 2.625a1 1 0 0 1 3 3l-9.013 9.014a2 2 0 0 1-.853.505l-2.873.84a.5.5 0 0 1-.62-.62l.84-2.873a2 2 0 0 1 .506-.852z",key:"ohrbg2"}]]);/**
 * @license lucide-vue-next v0.468.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Y=V("TrashIcon",[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}]]),Z={class:"flex flex-col gap-4 p-4"},ee={class:"grid gap-4 grid-cols-2 sm:grid-cols-2 md:grid-cols-2 lg:grid-cols-5"},te={class:"kpi-card"},se={class:"kpi-card"},ae={class:"flex flex-wrap gap-4 mb-4 p-2 items-center"},le=["value"],oe={class:"relative global-menu"},re={key:0,class:"absolute right-0 mt-2 w-48 bg-white dark:bg-gray-800 border rounded shadow-lg z-50"},ne={class:"grid gap-4 sm:grid-cols-2 md:grid-cols-3 lg:grid-cols-5"},ie=["onTouchstart","onTouchmove","onTouchend"],ue=["src","alt"],de={key:1,class:"w-full h-full bg-gray-200 flex items-center justify-center rounded"},ce={class:"absolute bottom-2 right-2 flex gap-2 z-50"},ge=["onClick"],me={class:"flex-1 flex flex-col justify-between mt-2 px-2 pb-2"},he={class:"font-bold truncate"},pe={class:"text-sm text-gray-600 dark:text-gray-300"},ve={class:"flex justify-between items-center mt-1"},fe={class:"font-semibold"},ye={class:"flex items-center text-gray-600 dark:text-gray-300 text-sm"},je=A({__name:"Index",props:{products:{},stats:{},filters:{},categories:{}},setup($){const n=$,p=c(n.filters.search||""),v=c(n.filters.category||""),b=c(!1);function E(e){return e?`/${e}`:"/fallback.png"}const j=T(()=>n.products.data.map(e=>({...e,images:e.images.length?e.images.map(s=>({path:s.url_image})):[]}))),f=T(()=>{let e=j.value;return p.value&&(e=e.filter(s=>s.title.toLowerCase().includes(p.value.toLowerCase()))),v.value&&(e=e.filter(s=>s.category?.id==v.value)),e}),F=e=>{confirm("Voulez-vous vraiment supprimer ce produit ?")&&J.Inertia.delete(`/admin/products/${e}`,{preserveScroll:!0})},u=c({});let k=null;B(()=>{k=setInterval(()=>{f.value.forEach(e=>{e.images.length>1&&(u.value[e.id]=((u.value[e.id]||0)+1)%e.images.length)})},3e3)}),U(()=>{k&&clearInterval(k)});const x=c({}),_=c({});function P(e,s){x.value[s]=e.touches[0].clientX}function S(e,s){_.value[s]=e.touches[0].clientX}function z(e){const s=x.value[e],t=_.value[e];if(s!=null&&t!=null){const i=s-t;if(i>50)u.value[e]=(u.value[e]+1)%f.value.find(d=>d.id===e)?.images.length;else if(i<-50){const d=f.value.find(L=>L.id===e)?.images.length;u.value[e]=(u.value[e]-1+d)%d}}x.value[e]=0,_.value[e]=0}const N=[{title:"Produits",href:"/admin/products"}];return(e,s)=>(l(),o(h,null,[e.$page.props.flash?.message?(l(),X(O,{key:0,message:e.$page.props.flash.message,link:e.$page.props.flash.link},null,8,["message","link"])):C("",!0),g(m(H),{title:"Produits"}),g(K,{breadcrumbs:N},{default:w(()=>[a("div",Z,[a("div",ee,[a("div",te,[s[3]||(s[3]=a("h3",null,"Total Produits",-1)),a("p",null,r(n.stats.total),1)]),a("div",se,[s[4]||(s[4]=a("h3",null,"Ajoutés cette semaine",-1)),a("p",null,r(n.stats.addedThisWeek),1)]),(l(!0),o(h,null,y(n.stats.byCategory,t=>(l(),o("div",{key:t.category?.id,class:"kpi-card"},[a("h3",null,r(t.category?.name||"Non catégorisé"),1),a("p",null,r(t.count),1)]))),128)),(l(!0),o(h,null,y(n.stats.byCategory,t=>(l(),o("div",{key:t.category?.id,class:"kpi-card"},[s[5]||(s[5]=a("h3",null,"Total Likes",-1)),a("p",null,r(n.products.data.reduce((i,d)=>i+d.likes_count,0)),1)]))),128))]),a("div",ae,[M(a("input",{"onUpdate:modelValue":s[0]||(s[0]=t=>p.value=t),placeholder:"Rechercher un produit...",class:"border p-2 rounded flex-1 min-w-[200px]"},null,512),[[q,p.value]]),M(a("select",{"onUpdate:modelValue":s[1]||(s[1]=t=>v.value=t),class:"border p-2 rounded min-w-[160px]"},[s[6]||(s[6]=a("option",{value:""},"Toutes les catégories",-1)),(l(!0),o(h,null,y(n.categories,t=>(l(),o("option",{key:t.id,value:t.id},r(t.name),9,le))),128))],512),[[D,v.value]]),a("div",oe,[a("button",{onClick:s[2]||(s[2]=G(t=>b.value=!b.value,["stop"])),class:"p-2 border rounded hover:bg-gray-100 dark:hover:bg-gray-700"},"⋮"),b.value?(l(),o("div",re,[a("ul",null,[a("li",null,[g(m(I),{prefetch:"",href:m(R).create().url,class:"block px-4 py-2 hover:bg-gray-100 dark:hover:bg-gray-700 text-sm"},{default:w(()=>[...s[7]||(s[7]=[W(" Créer un produit ",-1)])]),_:1},8,["href"])])])])):C("",!0)])]),a("div",ne,[(l(!0),o(h,null,y(f.value,t=>(l(),o("div",{key:t.id,class:"border rounded flex flex-col gap-2 bg-white dark:bg-[#1E1E1E] relative overflow-hidden"},[a("div",{class:"relative rounded min-h-[160px] sm:min-h-[200px] md:min-h-[240px] lg:min-h-[260px]",onTouchstart:i=>P(i,t.id),onTouchmove:i=>S(i,t.id),onTouchend:()=>z(t.id)},[t.images.length?(l(),o("img",{key:0,src:E(t.images[u.value[t.id]||0]?.path),alt:t.title,class:"w-full h-full object-cover rounded transition-opacity duration-700",loading:"lazy"},null,8,ue)):(l(),o("div",de,[...s[8]||(s[8]=[a("span",{class:"text-gray-500 text-sm"},"Aucune image",-1)])])),a("div",ce,[g(m(I),{href:`/admin/products/${t.id}/edit`,class:"p-1 bg-blue-500 text-white rounded hover:bg-blue-600"},{default:w(()=>[g(m(Q),{class:"w-4 h-4"})]),_:1},8,["href"]),a("button",{onClick:i=>F(t.id),class:"p-1 bg-red-500 text-white rounded hover:bg-red-600"},[g(m(Y),{class:"w-4 h-4"})],8,ge)])],40,ie),a("div",me,[a("h3",he,r(t.title),1),a("p",pe,r(t.category?.name||"Non catégorisé"),1),a("div",ve,[a("p",fe,r(t.prix)+" FCFA",1),a("div",ye," ❤️ "+r(t.likes_count),1)])])]))),128))])])]),_:1})],64))}});export{je as default};
