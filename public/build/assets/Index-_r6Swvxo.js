import{d as H,y as g,c as w,l as D,p as G,B as W,J as S,G as q,a as l,f as J,g as T,e as u,u as m,h as K,w as C,b as a,t as n,o,F as v,z as b,H as $,I as O,K as Q,v as R,A as I,j as Y,L as Z,N as M}from"./app-BigJ7tdX.js";import{p as ee,_ as te}from"./AppLayout.vue_vue_type_script_setup_true_lang-enZ54RAD.js";import{F as se}from"./FlashMessageFrontend-NKvlbeHd.js";import{_ as ae}from"./BackButton-C21Oiyb9.js";import{S as oe,T as le}from"./trash-TeYSlUxE.js";import"./index-Cn6ZYd1c.js";import"./useForwardExpose-DCsBqhPf.js";import"./VisuallyHidden-G2lYgh_E.js";import"./RovingFocusGroup-9-ke9Qyn.js";import"./useArrowNavigation-C6Y-ieo6.js";import"./index-BdvXPHPK.js";import"./createLucideIcon-C3-Gi7Pr.js";import"./AppLogoIcon.vue_vue_type_script_setup_true_lang-CRsIALfm.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";const re={class:"flex flex-col gap-4 p-4"},ne={class:"grid gap-4 grid-cols-2 sm:grid-cols-2 md:grid-cols-2 lg:grid-cols-5"},ie={class:"kpi-card"},ue={class:"kpi-card"},ce={class:"kpi-card"},de={class:"flex flex-wrap gap-4 mb-4 p-2 items-center"},ge={class:"relative flex-1 min-w-[400px]"},me={class:"relative"},pe=["value"],ve={class:"relative global-menu"},he={key:0,class:"absolute right-0 mt-2 w-48 bg-white dark:bg-gray-800 border rounded shadow-lg z-50"},fe={class:"grid gap-4 sm:grid-cols-2 md:grid-cols-3 lg:grid-cols-5"},be=["onTouchstart","onTouchmove","onTouchend"],xe=["src","alt"],ye={key:1,class:"w-full h-full bg-gray-200 flex items-center justify-center rounded"},_e={class:"absolute bottom-2 right-2 flex gap-2 z-50"},ke=["onClick"],we={class:"flex-1 flex flex-col justify-between mt-2 px-2 pb-2"},Te={class:"font-bold truncate"},Ce={class:"text-sm text-gray-600 dark:text-gray-300"},Se={class:"flex justify-between items-center mt-1"},$e={class:"font-semibold"},Ie={class:"flex items-center text-gray-600 dark:text-gray-300 text-sm"},Me={class:"flex justify-center mt-6 mb-10"},Ee={class:"inline-flex gap-2"},Le=["innerHTML","onClick"],qe=H({__name:"Index",props:{products:{},stats:{},filters:{},categories:{}},setup(E){const i=E,c=g(i.filters.search||""),p=g(i.filters.category||""),x=g(!1);function L(e){return e?`/${e}`:"/fallback.png"}const P=w(()=>i.products.data.map(e=>({...e,images:e.images.length?e.images.map(t=>({path:t.url_image})):[]}))),h=w(()=>{let e=P.value;return c.value&&(e=e.filter(t=>t.title.toLowerCase().includes(c.value.toLowerCase()))),p.value&&(e=e.filter(t=>t.category?.id==p.value)),e}),j=e=>{confirm("Voulez-vous vraiment supprimer ce produit ?")&&S.Inertia.delete(`/admin/products/${e}`,{preserveScroll:!0})},d=g({});let y=null;D(()=>{y=setInterval(()=>{h.value.forEach(e=>{e.images.length>1&&(d.value[e.id]=((d.value[e.id]||0)+1)%e.images.length)})},3e3)}),G(()=>{y&&clearInterval(y)});const _=g({}),k=g({});function F(e,t){_.value[t]=e.touches[0].clientX}function N(e,t){k.value[t]=e.touches[0].clientX}function V(e){const t=_.value[e],f=k.value[e];if(t!=null&&f!=null){const s=t-f;if(s>50)d.value[e]=(d.value[e]+1)%h.value.find(r=>r.id===e)?.images.length;else if(s<-50){const r=h.value.find(X=>X.id===e)?.images.length;d.value[e]=(d.value[e]-1+r)%r}}_.value[e]=0,k.value[e]=0}const z=[{title:"Produits",href:"/admin/products"}],B=w(()=>i.products.data.reduce((e,t)=>e+t.likes_count,0)),A=e=>{e&&M.visit(e,{preserveScroll:!0,preserveState:!0,only:["products"]})};W([c,p],([e,t])=>{S.Inertia.get("/admin/products",{search:e,category:t},{preserveState:!0,replace:!0})});function U(){c.value="",M.get("/admin/products",{},{preserveState:!0,replace:!0})}return(e,t)=>{const f=q("font-awesome-icon");return o(),l(v,null,[e.$page.props.flash?.message?(o(),J(se,{key:0,message:e.$page.props.flash.message,link:e.$page.props.flash.link},null,8,["message","link"])):T("",!0),u(m(K),{title:"Produits"}),u(te,{breadcrumbs:z},{default:C(()=>[a("div",re,[u(ae,{class:"m-4"}),a("div",ne,[a("div",ie,[t[3]||(t[3]=a("h3",null,"Total Produits",-1)),a("p",null,n(i.stats.total),1)]),a("div",ue,[t[4]||(t[4]=a("h3",null,"Ajoutés cette semaine",-1)),a("p",null,n(i.stats.addedThisWeek),1)]),(o(!0),l(v,null,b(i.stats.byCategory,s=>(o(),l("div",{key:s.category?.id,class:"kpi-card"},[a("h3",null,n(s.category?.name||"Non catégorisé"),1),a("p",null,n(s.count),1)]))),128)),a("div",ce,[t[5]||(t[5]=a("h3",null,"Total Likes",-1)),a("p",null,n(B.value),1)])]),t[9]||(t[9]=a("h1",{class:"text-xl font-bold mb-4 text-[var(--primary-blue)] dark:text-[var(--dark-gold)] my-2"}," Produits ",-1)),a("div",de,[a("div",ge,[a("div",me,[$(a("input",{"onUpdate:modelValue":t[0]||(t[0]=s=>c.value=s),type:"text",placeholder:"Search...",class:"custom-input"},null,512),[[O,c.value]]),u(f,{icon:"magnifying-glass",class:"custom-icon"})]),c.value?(o(),l("button",{key:0,onClick:U,class:"absolute right-2 top-1/2 -translate-y-1/2 text-gray-400 hover:text-gray-600",type:"button"}," ✕ ")):T("",!0)]),$(a("select",{"onUpdate:modelValue":t[1]||(t[1]=s=>p.value=s),class:"border p-2 rounded min-w-[160px]"},[t[6]||(t[6]=a("option",{value:""},"Toutes les catégories",-1)),(o(!0),l(v,null,b(i.categories,s=>(o(),l("option",{key:s.id,value:s.id},n(s.name),9,pe))),128))],512),[[Q,p.value]]),a("div",ve,[a("button",{onClick:t[2]||(t[2]=R(s=>x.value=!x.value,["stop"])),class:"p-2 border rounded hover:bg-gray-100 dark:hover:bg-gray-700"},"⋮"),x.value?(o(),l("div",he,[a("ul",null,[a("li",null,[u(m(I),{prefetch:"",href:m(ee).create().url,class:"block px-4 py-2 hover:bg-gray-100 dark:hover:bg-gray-700 text-sm"},{default:C(()=>[...t[7]||(t[7]=[Y(" Créer un produit ",-1)])]),_:1},8,["href"])])])])):T("",!0)])]),a("div",fe,[(o(!0),l(v,null,b(h.value,s=>(o(),l("div",{key:s.id,class:"border rounded flex flex-col gap-2 bg-white dark:bg-[#1E1E1E] relative overflow-hidden"},[a("div",{class:"relative rounded min-h-[160px] sm:min-h-[200px] md:min-h-[240px] lg:min-h-[260px]",onTouchstart:r=>F(r,s.id),onTouchmove:r=>N(r,s.id),onTouchend:()=>V(s.id)},[s.images.length?(o(),l("img",{key:0,src:L(s.images[d.value[s.id]||0]?.path),alt:s.title,class:"w-full h-full object-cover rounded transition-opacity duration-700",loading:"lazy"},null,8,xe)):(o(),l("div",ye,[...t[8]||(t[8]=[a("span",{class:"text-gray-500 text-sm"},"Aucune image",-1)])])),a("div",_e,[u(m(I),{href:`/admin/products/${s.id}/edit`,class:"p-1 bg-blue-500 text-white rounded hover:bg-blue-600"},{default:C(()=>[u(m(oe),{class:"w-4 h-4"})]),_:1},8,["href"]),a("button",{onClick:r=>j(s.id),class:"p-1 bg-red-500 text-white rounded hover:bg-red-600"},[u(m(le),{class:"w-4 h-4"})],8,ke)])],40,be),a("div",we,[a("h3",Te,n(s.title),1),a("p",Ce,n(s.category?.name||"Non catégorisé"),1),a("div",Se,[a("p",$e,n(s.prix)+" FCFA",1),a("div",Ie," ❤️ "+n(s.likes_count),1)])])]))),128))]),a("div",Me,[a("nav",Ee,[(o(!0),l(v,null,b(i.products.links,s=>(o(),l("button",{key:s.label,innerHTML:s.label,onClick:r=>A(s.url),class:Z(["px-3 py-1 border rounded text-sm transition",{"bg-blue-600 text-white border-blue-600":s.active,"text-gray-700 dark:text-gray-200 hover:bg-gray-100 dark:hover:bg-gray-700":!s.active,"opacity-50 cursor-not-allowed":!s.url}])},null,10,Le))),128))])])])]),_:1})],64)}}});export{qe as default};
