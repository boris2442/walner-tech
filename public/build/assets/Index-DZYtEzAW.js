import{d as B,y as d,c as _,l as U,p as X,a as o,f as H,g as M,e as c,u as g,h as q,w,b as s,t as r,o as a,F as f,z as T,G as C,H as D,J as G,v as W,A as I,j as J,I as R}from"./app-B47QzxcG.js";import{p as K,_ as O}from"./AppLayout.vue_vue_type_script_setup_true_lang-CGAs6LvS.js";import{F as Q}from"./FlashMessageFrontend-ReC8Ngin.js";import{c as V}from"./createLucideIcon-QbRATxF1.js";import"./index-BmIPlrjt.js";import"./useForwardExpose-CBFulA12.js";import"./VisuallyHidden-Buil-Apc.js";import"./RovingFocusGroup-DwCVCDNT.js";import"./useArrowNavigation-C6Y-ieo6.js";import"./index-BdvXPHPK.js";import"./AppLogoIcon.vue_vue_type_script_setup_true_lang-DqHIzp5x.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";/**
 * @license lucide-vue-next v0.468.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Y=V("SquarePenIcon",[["path",{d:"M12 3H5a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7",key:"1m0v6g"}],["path",{d:"M18.375 2.625a1 1 0 0 1 3 3l-9.013 9.014a2 2 0 0 1-.853.505l-2.873.84a.5.5 0 0 1-.62-.62l.84-2.873a2 2 0 0 1 .506-.852z",key:"ohrbg2"}]]);/**
 * @license lucide-vue-next v0.468.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Z=V("TrashIcon",[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}]]),ee={class:"flex flex-col gap-4 p-4"},te={class:"grid gap-4 grid-cols-2 sm:grid-cols-2 md:grid-cols-2 lg:grid-cols-5"},se={class:"kpi-card"},le={class:"kpi-card"},ae={class:"kpi-card"},oe={class:"flex flex-wrap gap-4 mb-4 p-2 items-center"},re=["value"],ne={class:"relative global-menu"},ie={key:0,class:"absolute right-0 mt-2 w-48 bg-white dark:bg-gray-800 border rounded shadow-lg z-50"},ue={class:"grid gap-4 sm:grid-cols-2 md:grid-cols-3 lg:grid-cols-5"},de=["onTouchstart","onTouchmove","onTouchend"],ce=["src","alt"],ge={key:1,class:"w-full h-full bg-gray-200 flex items-center justify-center rounded"},he={class:"absolute bottom-2 right-2 flex gap-2 z-50"},me=["onClick"],pe={class:"flex-1 flex flex-col justify-between mt-2 px-2 pb-2"},ve={class:"font-bold truncate"},fe={class:"text-sm text-gray-600 dark:text-gray-300"},be={class:"flex justify-between items-center mt-1"},ke={class:"font-semibold"},xe={class:"flex items-center text-gray-600 dark:text-gray-300 text-sm"},Pe=B({__name:"Index",props:{products:{},stats:{},filters:{},categories:{}},setup($){const n=$,h=d(n.filters.search||""),m=d(n.filters.category||""),b=d(!1);function E(e){return e?`/${e}`:"/fallback.png"}const j=_(()=>n.products.data.map(e=>({...e,images:e.images.length?e.images.map(t=>({path:t.url_image})):[]}))),p=_(()=>{let e=j.value;return h.value&&(e=e.filter(t=>t.title.toLowerCase().includes(h.value.toLowerCase()))),m.value&&(e=e.filter(t=>t.category?.id==m.value)),e}),F=e=>{confirm("Voulez-vous vraiment supprimer ce produit ?")&&R.Inertia.delete(`/admin/products/${e}`,{preserveScroll:!0})},i=d({});let k=null;U(()=>{k=setInterval(()=>{p.value.forEach(e=>{e.images.length>1&&(i.value[e.id]=((i.value[e.id]||0)+1)%e.images.length)})},3e3)}),X(()=>{k&&clearInterval(k)});const x=d({}),y=d({});function P(e,t){x.value[t]=e.touches[0].clientX}function S(e,t){y.value[t]=e.touches[0].clientX}function z(e){const t=x.value[e],l=y.value[e];if(t!=null&&l!=null){const u=t-l;if(u>50)i.value[e]=(i.value[e]+1)%p.value.find(v=>v.id===e)?.images.length;else if(u<-50){const v=p.value.find(A=>A.id===e)?.images.length;i.value[e]=(i.value[e]-1+v)%v}}x.value[e]=0,y.value[e]=0}const L=[{title:"Produits",href:"/admin/products"}],N=_(()=>n.products.data.reduce((e,t)=>e+t.likes_count,0));return(e,t)=>(a(),o(f,null,[e.$page.props.flash?.message?(a(),H(Q,{key:0,message:e.$page.props.flash.message,link:e.$page.props.flash.link},null,8,["message","link"])):M("",!0),c(g(q),{title:"Produits"}),c(O,{breadcrumbs:L},{default:w(()=>[s("div",ee,[s("div",te,[s("div",se,[t[3]||(t[3]=s("h3",null,"Total Produits",-1)),s("p",null,r(n.stats.total),1)]),s("div",le,[t[4]||(t[4]=s("h3",null,"Ajoutés cette semaine",-1)),s("p",null,r(n.stats.addedThisWeek),1)]),(a(!0),o(f,null,T(n.stats.byCategory,l=>(a(),o("div",{key:l.category?.id,class:"kpi-card"},[s("h3",null,r(l.category?.name||"Non catégorisé"),1),s("p",null,r(l.count),1)]))),128)),s("div",ae,[t[5]||(t[5]=s("h3",null,"Total Likes",-1)),s("p",null,r(N.value),1)])]),s("div",oe,[C(s("input",{"onUpdate:modelValue":t[0]||(t[0]=l=>h.value=l),placeholder:"Rechercher un produit...",class:"border p-2 rounded flex-1 min-w-[200px]"},null,512),[[D,h.value]]),C(s("select",{"onUpdate:modelValue":t[1]||(t[1]=l=>m.value=l),class:"border p-2 rounded min-w-[160px]"},[t[6]||(t[6]=s("option",{value:""},"Toutes les catégories",-1)),(a(!0),o(f,null,T(n.categories,l=>(a(),o("option",{key:l.id,value:l.id},r(l.name),9,re))),128))],512),[[G,m.value]]),s("div",ne,[s("button",{onClick:t[2]||(t[2]=W(l=>b.value=!b.value,["stop"])),class:"p-2 border rounded hover:bg-gray-100 dark:hover:bg-gray-700"},"⋮"),b.value?(a(),o("div",ie,[s("ul",null,[s("li",null,[c(g(I),{prefetch:"",href:g(K).create().url,class:"block px-4 py-2 hover:bg-gray-100 dark:hover:bg-gray-700 text-sm"},{default:w(()=>[...t[7]||(t[7]=[J(" Créer un produit ",-1)])]),_:1},8,["href"])])])])):M("",!0)])]),s("div",ue,[(a(!0),o(f,null,T(p.value,l=>(a(),o("div",{key:l.id,class:"border rounded flex flex-col gap-2 bg-white dark:bg-[#1E1E1E] relative overflow-hidden"},[s("div",{class:"relative rounded min-h-[160px] sm:min-h-[200px] md:min-h-[240px] lg:min-h-[260px]",onTouchstart:u=>P(u,l.id),onTouchmove:u=>S(u,l.id),onTouchend:()=>z(l.id)},[l.images.length?(a(),o("img",{key:0,src:E(l.images[i.value[l.id]||0]?.path),alt:l.title,class:"w-full h-full object-cover rounded transition-opacity duration-700",loading:"lazy"},null,8,ce)):(a(),o("div",ge,[...t[8]||(t[8]=[s("span",{class:"text-gray-500 text-sm"},"Aucune image",-1)])])),s("div",he,[c(g(I),{href:`/admin/products/${l.id}/edit`,class:"p-1 bg-blue-500 text-white rounded hover:bg-blue-600"},{default:w(()=>[c(g(Y),{class:"w-4 h-4"})]),_:1},8,["href"]),s("button",{onClick:u=>F(l.id),class:"p-1 bg-red-500 text-white rounded hover:bg-red-600"},[c(g(Z),{class:"w-4 h-4"})],8,me)])],40,de),s("div",pe,[s("h3",ve,r(l.title),1),s("p",fe,r(l.category?.name||"Non catégorisé"),1),s("div",be,[s("p",ke,r(l.prix)+" FCFA",1),s("div",xe," ❤️ "+r(l.likes_count),1)])])]))),128))])])]),_:1})],64))}});export{Pe as default};
