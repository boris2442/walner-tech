import{d as q,y as g,c as w,l as D,p as G,B as W,J as M,G as J,a as l,f as K,g as T,e as d,u as m,h as O,w as C,b as s,t as n,o,F as v,z as y,H as S,I as Q,K as R,v as Y,A as I,j as Z,L as ee,T as $}from"./app-DBOWHw-W.js";import{p as te,_ as se}from"./AppLayout.vue_vue_type_script_setup_true_lang-ClXAYKQF.js";import{F as ae}from"./FlashMessageFrontend-DOA7b_9i.js";import{c as L}from"./createLucideIcon-Df5QKm0L.js";import"./index-DDL7UkmU.js";import"./useForwardExpose-Bu4cHvxX.js";import"./VisuallyHidden-vYu_52GT.js";import"./RovingFocusGroup-kzMASxfM.js";import"./useArrowNavigation-C6Y-ieo6.js";import"./index-BdvXPHPK.js";import"./AppLogoIcon.vue_vue_type_script_setup_true_lang-DTprrQd4.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";/**
 * @license lucide-vue-next v0.468.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const oe=L("SquarePenIcon",[["path",{d:"M12 3H5a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7",key:"1m0v6g"}],["path",{d:"M18.375 2.625a1 1 0 0 1 3 3l-9.013 9.014a2 2 0 0 1-.853.505l-2.873.84a.5.5 0 0 1-.62-.62l.84-2.873a2 2 0 0 1 .506-.852z",key:"ohrbg2"}]]);/**
 * @license lucide-vue-next v0.468.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const le=L("TrashIcon",[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}]]),re={class:"flex flex-col gap-4 p-4"},ne={class:"grid gap-4 grid-cols-2 sm:grid-cols-2 md:grid-cols-2 lg:grid-cols-5"},ie={class:"kpi-card"},ue={class:"kpi-card"},ce={class:"kpi-card"},de={class:"flex flex-wrap gap-4 mb-4 p-2 items-center"},ge={class:"relative flex-1 min-w-[400px]"},me={class:"relative"},pe=["value"],ve={class:"relative global-menu"},he={key:0,class:"absolute right-0 mt-2 w-48 bg-white dark:bg-gray-800 border rounded shadow-lg z-50"},fe={class:"grid gap-4 sm:grid-cols-2 md:grid-cols-3 lg:grid-cols-5"},ye=["onTouchstart","onTouchmove","onTouchend"],be=["src","alt"],_e={key:1,class:"w-full h-full bg-gray-200 flex items-center justify-center rounded"},xe={class:"absolute bottom-2 right-2 flex gap-2 z-50"},ke=["onClick"],we={class:"flex-1 flex flex-col justify-between mt-2 px-2 pb-2"},Te={class:"font-bold truncate"},Ce={class:"text-sm text-gray-600 dark:text-gray-300"},Me={class:"flex justify-between items-center mt-1"},Se={class:"font-semibold"},Ie={class:"flex items-center text-gray-600 dark:text-gray-300 text-sm"},$e={class:"flex justify-center mt-6 mb-10"},Le={class:"inline-flex gap-2"},Ve=["innerHTML","onClick"],De=q({__name:"Index",props:{products:{},stats:{},filters:{},categories:{}},setup(V){const i=V,u=g(i.filters.search||""),p=g(i.filters.category||""),b=g(!1);function j(e){return e?`/${e}`:"/fallback.png"}const E=w(()=>i.products.data.map(e=>({...e,images:e.images.length?e.images.map(a=>({path:a.url_image})):[]}))),h=w(()=>{let e=E.value;return u.value&&(e=e.filter(a=>a.title.toLowerCase().includes(u.value.toLowerCase()))),p.value&&(e=e.filter(a=>a.category?.id==p.value)),e}),P=e=>{confirm("Voulez-vous vraiment supprimer ce produit ?")&&M.Inertia.delete(`/admin/products/${e}`,{preserveScroll:!0})},c=g({});let _=null;D(()=>{_=setInterval(()=>{h.value.forEach(e=>{e.images.length>1&&(c.value[e.id]=((c.value[e.id]||0)+1)%e.images.length)})},3e3)}),G(()=>{_&&clearInterval(_)});const x=g({}),k=g({});function z(e,a){x.value[a]=e.touches[0].clientX}function F(e,a){k.value[a]=e.touches[0].clientX}function N(e){const a=x.value[e],f=k.value[e];if(a!=null&&f!=null){const t=a-f;if(t>50)c.value[e]=(c.value[e]+1)%h.value.find(r=>r.id===e)?.images.length;else if(t<-50){const r=h.value.find(X=>X.id===e)?.images.length;c.value[e]=(c.value[e]-1+r)%r}}x.value[e]=0,k.value[e]=0}const B=[{title:"Produits",href:"/admin/products"}],H=w(()=>i.products.data.reduce((e,a)=>e+a.likes_count,0)),A=e=>{e&&$.visit(e,{preserveScroll:!0,preserveState:!0,only:["products"]})};W([u,p],([e,a])=>{M.Inertia.get("/admin/products",{search:e,category:a},{preserveState:!0,replace:!0})});function U(){u.value="",$.get("/admin/products",{},{preserveState:!0,replace:!0})}return(e,a)=>{const f=J("font-awesome-icon");return o(),l(v,null,[e.$page.props.flash?.message?(o(),K(ae,{key:0,message:e.$page.props.flash.message,link:e.$page.props.flash.link},null,8,["message","link"])):T("",!0),d(m(O),{title:"Produits"}),d(se,{breadcrumbs:B},{default:C(()=>[s("div",re,[s("div",ne,[s("div",ie,[a[3]||(a[3]=s("h3",null,"Total Produits",-1)),s("p",null,n(i.stats.total),1)]),s("div",ue,[a[4]||(a[4]=s("h3",null,"Ajoutés cette semaine",-1)),s("p",null,n(i.stats.addedThisWeek),1)]),(o(!0),l(v,null,y(i.stats.byCategory,t=>(o(),l("div",{key:t.category?.id,class:"kpi-card"},[s("h3",null,n(t.category?.name||"Non catégorisé"),1),s("p",null,n(t.count),1)]))),128)),s("div",ce,[a[5]||(a[5]=s("h3",null,"Total Likes",-1)),s("p",null,n(H.value),1)])]),s("div",de,[s("div",ge,[s("div",me,[S(s("input",{"onUpdate:modelValue":a[0]||(a[0]=t=>u.value=t),type:"text",placeholder:"Search...",class:"custom-input"},null,512),[[Q,u.value]]),d(f,{icon:"magnifying-glass",class:"custom-icon"})]),u.value?(o(),l("button",{key:0,onClick:U,class:"absolute right-2 top-1/2 -translate-y-1/2 text-gray-400 hover:text-gray-600",type:"button"}," ✕ ")):T("",!0)]),S(s("select",{"onUpdate:modelValue":a[1]||(a[1]=t=>p.value=t),class:"border p-2 rounded min-w-[160px]"},[a[6]||(a[6]=s("option",{value:""},"Toutes les catégories",-1)),(o(!0),l(v,null,y(i.categories,t=>(o(),l("option",{key:t.id,value:t.id},n(t.name),9,pe))),128))],512),[[R,p.value]]),s("div",ve,[s("button",{onClick:a[2]||(a[2]=Y(t=>b.value=!b.value,["stop"])),class:"p-2 border rounded hover:bg-gray-100 dark:hover:bg-gray-700"},"⋮"),b.value?(o(),l("div",he,[s("ul",null,[s("li",null,[d(m(I),{prefetch:"",href:m(te).create().url,class:"block px-4 py-2 hover:bg-gray-100 dark:hover:bg-gray-700 text-sm"},{default:C(()=>[...a[7]||(a[7]=[Z(" Créer un produit ",-1)])]),_:1},8,["href"])])])])):T("",!0)])]),s("div",fe,[(o(!0),l(v,null,y(h.value,t=>(o(),l("div",{key:t.id,class:"border rounded flex flex-col gap-2 bg-white dark:bg-[#1E1E1E] relative overflow-hidden"},[s("div",{class:"relative rounded min-h-[160px] sm:min-h-[200px] md:min-h-[240px] lg:min-h-[260px]",onTouchstart:r=>z(r,t.id),onTouchmove:r=>F(r,t.id),onTouchend:()=>N(t.id)},[t.images.length?(o(),l("img",{key:0,src:j(t.images[c.value[t.id]||0]?.path),alt:t.title,class:"w-full h-full object-cover rounded transition-opacity duration-700",loading:"lazy"},null,8,be)):(o(),l("div",_e,[...a[8]||(a[8]=[s("span",{class:"text-gray-500 text-sm"},"Aucune image",-1)])])),s("div",xe,[d(m(I),{href:`/admin/products/${t.id}/edit`,class:"p-1 bg-blue-500 text-white rounded hover:bg-blue-600"},{default:C(()=>[d(m(oe),{class:"w-4 h-4"})]),_:1},8,["href"]),s("button",{onClick:r=>P(t.id),class:"p-1 bg-red-500 text-white rounded hover:bg-red-600"},[d(m(le),{class:"w-4 h-4"})],8,ke)])],40,ye),s("div",we,[s("h3",Te,n(t.title),1),s("p",Ce,n(t.category?.name||"Non catégorisé"),1),s("div",Me,[s("p",Se,n(t.prix)+" FCFA",1),s("div",Ie," ❤️ "+n(t.likes_count),1)])])]))),128))]),s("div",$e,[s("nav",Le,[(o(!0),l(v,null,y(i.products.links,t=>(o(),l("button",{key:t.label,innerHTML:t.label,onClick:r=>A(t.url),class:ee(["px-3 py-1 border rounded text-sm transition",{"bg-blue-600 text-white border-blue-600":t.active,"text-gray-700 dark:text-gray-200 hover:bg-gray-100 dark:hover:bg-gray-700":!t.active,"opacity-50 cursor-not-allowed":!t.url}])},null,10,Ve))),128))])])])]),_:1})],64)}}});export{De as default};
