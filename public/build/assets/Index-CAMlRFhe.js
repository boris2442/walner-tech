import{d as Y,y as m,c as w,l as G,p as W,B as q,J as S,G as J,a as l,f as K,g as T,e as u,u as g,h as O,w as C,b as t,t as r,o,F as v,z as b,H as M,I as Q,K as R,v as Z,A as $,j as ee,L as te,N as I}from"./app-CKkDLC8m.js";import{p as L,_ as se}from"./AppLayout.vue_vue_type_script_setup_true_lang-Dbgxv9Q0.js";import{F as ae}from"./FlashMessageFrontend-B5vdpULS.js";import{d as oe}from"./index-BdvXPHPK.js";import{d as le}from"./dayjs.min-CL7bhMfm.js";import{_ as re}from"./BackButton-Cb9PGyid.js";import{S as ne,T as ie}from"./trash-Bkh9IOFF.js";import"./index-DzkENJN6.js";import"./useForwardExpose-DQiXlYni.js";import"./VisuallyHidden-CRMeg8VA.js";import"./RovingFocusGroup-0nsnC0Mz.js";import"./useArrowNavigation-C6Y-ieo6.js";import"./createLucideIcon-DPStJGvs.js";import"./AppLogoIcon.vue_vue_type_script_setup_true_lang-CFOSTd1U.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";const ue={class:"flex flex-col gap-4 p-4"},de={class:"grid gap-4 grid-cols-2 sm:grid-cols-2 md:grid-cols-2 lg:grid-cols-5"},ce={class:"kpi-card"},me={class:"kpi-card"},ge={class:"kpi-card"},pe={class:"flex flex-wrap gap-4 mb-4 p-2 items-center"},ve={class:"relative flex-1 min-w-[400px]"},he={class:"relative"},fe=["value"],be={class:"relative global-menu"},xe={key:0,class:"absolute right-0 mt-2 w-48 bg-white dark:bg-gray-800 border rounded shadow-lg z-50"},_e={class:"grid gap-4 sm:grid-cols-2 md:grid-cols-3 lg:grid-cols-5"},ye=["onTouchstart","onTouchmove","onTouchend"],ke=["src","alt"],we={key:1,class:"w-full h-full bg-gray-200 flex items-center justify-center rounded"},Te={class:"absolute bottom-2 right-2 flex gap-2 z-50"},Ce=["onClick"],Se={class:"flex-1 flex flex-col justify-between mt-2 px-2 pb-2"},Me={class:"font-bold truncate"},$e={class:"text-sm text-gray-600 dark:text-gray-300"},Ie={class:"flex justify-between items-center mt-1"},Le={class:"font-semibold"},je={class:"flex items-center text-gray-600 dark:text-gray-300 text-sm"},Ee={class:"text-xs"},Pe={class:"flex justify-center mt-6 mb-10"},Fe={class:"inline-flex gap-2"},Ne=["innerHTML","onClick"],Qe=Y({__name:"Index",props:{products:{},stats:{},filters:{},categories:{}},setup(j){const i=j,d=m(i.filters.search||""),p=m(i.filters.category||""),x=m(!1);function E(e){return e?`/${e}`:"/fallback.png"}const P=w(()=>i.products.data.map(e=>({...e,images:e.images.length?e.images.map(a=>({path:a.url_image})):[]}))),h=w(()=>{let e=P.value;return d.value&&(e=e.filter(a=>a.title.toLowerCase().includes(d.value.toLowerCase()))),p.value&&(e=e.filter(a=>a.category?.id==p.value)),e}),F=e=>{confirm("Voulez-vous vraiment supprimer ce produit ?")&&S.Inertia.delete(`/admin/products/${e}`,{preserveScroll:!0})},c=m({});let _=null;G(()=>{_=setInterval(()=>{h.value.forEach(e=>{e.images.length>1&&(c.value[e.id]=((c.value[e.id]||0)+1)%e.images.length)})},3e3)}),W(()=>{_&&clearInterval(_)});const y=m({}),k=m({});function N(e,a){y.value[a]=e.touches[0].clientX}function V(e,a){k.value[a]=e.touches[0].clientX}function z(e){const a=y.value[e],f=k.value[e];if(a!=null&&f!=null){const s=a-f;if(s>50)c.value[e]=(c.value[e]+1)%h.value.find(n=>n.id===e)?.images.length;else if(s<-50){const n=h.value.find(X=>X.id===e)?.images.length;c.value[e]=(c.value[e]-1+n)%n}}y.value[e]=0,k.value[e]=0}const B=[{title:"dashboard",href:oe().url},{title:"Products List",href:L.index().url}],D=w(()=>i.products.data.reduce((e,a)=>e+a.likes_count,0)),H=e=>{e&&I.visit(e,{preserveScroll:!0,preserveState:!0,only:["products"]})};q([d,p],([e,a])=>{S.Inertia.get("/admin/products",{search:e,category:a},{preserveState:!0,replace:!0})});function A(){d.value="",I.get("/admin/products",{},{preserveState:!0,replace:!0})}function U(e){return le(e).format("DD/MM/YYYY HH:mm")}return(e,a)=>{const f=J("font-awesome-icon");return o(),l(v,null,[e.$page.props.flash?.message?(o(),K(ae,{key:0,message:e.$page.props.flash.message,link:e.$page.props.flash.link},null,8,["message","link"])):T("",!0),u(g(O),{title:"Produits"}),u(se,{breadcrumbs:B},{default:C(()=>[t("div",ue,[u(re,{class:"m-4"}),t("div",de,[t("div",ce,[a[3]||(a[3]=t("h3",null,"Total Produits",-1)),t("p",null,r(i.stats.total),1)]),t("div",me,[a[4]||(a[4]=t("h3",null,"Ajoutés cette semaine",-1)),t("p",null,r(i.stats.addedThisWeek),1)]),(o(!0),l(v,null,b(i.stats.byCategory,s=>(o(),l("div",{key:s.category?.id,class:"kpi-card"},[t("h3",null,r(s.category?.name||"Non catégorisé"),1),t("p",null,r(s.count),1)]))),128)),t("div",ge,[a[5]||(a[5]=t("h3",null,"Total Likes",-1)),t("p",null,r(D.value),1)])]),a[9]||(a[9]=t("h1",{class:"text-xl font-bold mb-4 text-[var(--primary-blue)] dark:text-[var(--dark-gold)] my-2"}," Produits ",-1)),t("div",pe,[t("div",ve,[t("div",he,[M(t("input",{"onUpdate:modelValue":a[0]||(a[0]=s=>d.value=s),type:"text",placeholder:"Search...",class:"custom-input"},null,512),[[Q,d.value]]),u(f,{icon:"magnifying-glass",class:"custom-icon"})]),d.value?(o(),l("button",{key:0,onClick:A,class:"absolute right-2 top-1/2 -translate-y-1/2 text-gray-400 hover:text-gray-600",type:"button"}," ✕ ")):T("",!0)]),M(t("select",{"onUpdate:modelValue":a[1]||(a[1]=s=>p.value=s),class:"border p-2 rounded min-w-[160px]"},[a[6]||(a[6]=t("option",{value:""},"Toutes les catégories",-1)),(o(!0),l(v,null,b(i.categories,s=>(o(),l("option",{key:s.id,value:s.id},r(s.name),9,fe))),128))],512),[[R,p.value]]),t("div",be,[t("button",{onClick:a[2]||(a[2]=Z(s=>x.value=!x.value,["stop"])),class:"p-2 border rounded hover:bg-gray-100 dark:hover:bg-gray-700"},"⋮"),x.value?(o(),l("div",xe,[t("ul",null,[t("li",null,[u(g($),{prefetch:"",href:g(L).create().url,class:"block px-4 py-2 hover:bg-gray-100 dark:hover:bg-gray-700 text-sm"},{default:C(()=>[...a[7]||(a[7]=[ee(" Créer un produit ",-1)])]),_:1},8,["href"])])])])):T("",!0)])]),t("div",_e,[(o(!0),l(v,null,b(h.value,s=>(o(),l("div",{key:s.id,class:"border rounded flex flex-col gap-2 bg-white dark:bg-[#1E1E1E] relative overflow-hidden"},[t("div",{class:"relative rounded min-h-[160px] sm:min-h-[200px] md:min-h-[240px] lg:min-h-[260px]",onTouchstart:n=>N(n,s.id),onTouchmove:n=>V(n,s.id),onTouchend:()=>z(s.id)},[s.images.length?(o(),l("img",{key:0,src:E(s.images[c.value[s.id]||0]?.path),alt:s.title,class:"w-full h-full object-cover rounded transition-opacity duration-700",loading:"lazy"},null,8,ke)):(o(),l("div",we,[...a[8]||(a[8]=[t("span",{class:"text-gray-500 text-sm"},"Aucune image",-1)])])),t("div",Te,[u(g($),{href:`/admin/products/${s.id}/edit`,prefetch:"",class:"p-1 bg-blue-500 text-white rounded hover:bg-blue-600"},{default:C(()=>[u(g(ne),{class:"w-4 h-4"})]),_:1},8,["href"]),t("button",{onClick:n=>F(s.id),class:"p-1 bg-red-500 text-white rounded hover:bg-red-600"},[u(g(ie),{class:"w-4 h-4"})],8,Ce)])],40,ye),t("div",Se,[t("h3",Me,r(s.title),1),t("p",$e,r(s.category?.name||"Non catégorisé"),1),t("div",Ie,[t("p",Le,r(s.prix)+" FCFA",1),t("div",je," ❤️ "+r(s.likes_count),1)])]),t("p",null,[t("i",Ee,"creer le "+r(U(s.created_at)),1)])]))),128))]),t("div",Pe,[t("nav",Fe,[(o(!0),l(v,null,b(i.products.links,s=>(o(),l("button",{key:s.label,innerHTML:s.label,onClick:n=>H(s.url),class:te(["px-3 py-1 border rounded text-sm transition",{"bg-blue-600 text-white border-blue-600":s.active,"text-gray-700 dark:text-gray-200 hover:bg-gray-100 dark:hover:bg-gray-700":!s.active,"opacity-50 cursor-not-allowed":!s.url}])},null,10,Ne))),128))])])])]),_:1})],64)}}});export{Qe as default};
